sudo: required

services:
- docker

language: java

jdk:
- oraclejdk10

script:
- ./gradlew check installDist
- docker build -t "irus/bkug:1.0.0-dev-b${TRAVIS_BUILD_NUMBER}" ./

deploy:
  provider: script
  script: bash docker_push.sh
  on:
    branch: master

before_cache:
- rm -f  "${HOME}/.gradle/caches/modules-2/modules-2.lock"
- rm -f  "${HOME}/.gradle/caches/*/fileHashes/fileHashes.lock"
- rm -rf "${HOME}/.gradle/caches/*/plugin-resolution/"

cache:
  directories:
  - "${HOME}/.gradle/caches/"
  - "${HOME}/.gradle/wrapper/"
